<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HNN Textbook</title>
    <!-- <base href="/textbook/"> -->
    <link href="https://fonts.googleapis.com/css2?family=Fira+Sans:wght@400&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../assets/styles.css">
    <script src="../../templates/scripts.js" defer></script>
</head>
<body>
    <svg style="display: none;">
        <symbol id="popup-symbol" viewBox="0 0 24 24" fill="none">
            <circle cx="12" cy="12" r="9" 
                fill="var(--fill-color, transparent)" 
                stroke="var(--stroke-color, currentColor)" 
                stroke-width="2" />
            <path d="M9 9L15 15M15 9L9 15" 
                stroke="var(--stroke-color, currentColor)" 
                stroke-width="2" 
                stroke-linecap="round" />
        </symbol>
    </svg>


	<div id="mySidebar" class="sidebar">
	    <div class="sidebar-close">
	    <svg class="popup-symbol" viewBox="0 0 24 24">
	    <use href="#popup-symbol" />
	    </svg>
	    </div>
	    <div class="navbar-header">
	        <div class="title-row">
	            <a>
	                Human Neocortical Neurosolver
	            </a>
	            <br>
	                <svg class="collapse-icon" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16">
	                    <path d="M9 9H4v1h5V9z"/>
	                    <path fill-rule="evenodd" clip-rule="evenodd" d="M5 3l1-1h7l1 1v7l-1 1h-2v2l-1 1H3l-1-1V6l1-1h2V3zm1 2h4l1 1v4h2V3H6v2zm4 1H3v7h7V6z"/>
	                </svg>
	        </div>
	        <div class="install-row">
	            <a class="download-icon-link">
	                <svg class="download-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
	                <path d="M7 19L5.78311 18.9954C3.12231 18.8818 1 16.6888 1 14C1 11.3501 3.06139 9.18169 5.66806 9.01084C6.78942 6.64027 9.20316 5 12 5C15.5268 5 18.4445 7.60822 18.9293 11.001L19 11C21.2091 11 23 12.7909 23 15C23 17.1422 21.316 18.8911 19.1996 18.9951L17 19M12 10V18M12 18L15 15M12 18L9 15" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
	                </svg>
	            </a>
	            <a>
	                Installation
	            </a>
	        </div>
	    </div>

		<a href="/textbook/content/preface.html">Preface</a>
		<div class="sidebar-list">
			<a id="sidebar-header" onclick="toggleSubmenu(event)">
		<span class="toggle-icon">+</span>
				1. Getting Started
			</a>
			<div class="submenu">
				<a href="/textbook/content/01_getting_started/challenge.html">1.1 Introducing HNN</a>
				<a href="/textbook/content/01_getting_started/template_model.html">1.2 Template Model</a>
				<a href="/textbook/content/01_getting_started/installation.html">1.3 Installation</a>
			</div>
		</div>
		<div class="sidebar-list">
			<a id="sidebar-header" onclick="toggleSubmenu(event)">
		<span class="toggle-icon">+</span>
				2. Model Assumptions
			</a>
			<div class="submenu">
				<a href="/textbook/content/03_model_assumptions/cortical_column_structure.html">2.1 Cortical Column Structure</a>
				<a href="/textbook/content/03_model_assumptions/primary_electric_currents.html">2.2 Primary Electrical Currents</a>
				<a href="/textbook/content/03_model_assumptions/neurons_morphology_and_physiology.html">2.3 Neurons: Morphology and Physiology</a>
				<a href="/textbook/content/03_model_assumptions/synaptic_connectivity.html">2.4 Synaptic Connectivity</a>
				<a href="/textbook/content/03_model_assumptions/evoked_and_rhythmic_driving_inputs.html">2.5 Evoked and Rhythmic Driving Inputs</a>
				<a href="/textbook/content/03_model_assumptions/tonic_and_noisy_driving_inputs.html">2.6 Tonic and Noisy Driving Inputs</a>
			</div>
		</div>
		<div class="sidebar-list">
			<a id="sidebar-header" onclick="toggleSubmenu(event)">
		<span class="toggle-icon">+</span>
				3. Using the HNN GUI
			</a>
			<div class="submenu">
				<a href="/textbook/content/04_using_hnn_gui/gui_quickstart.html">3.1 GUI Quickstart</a>
			</div>
		</div>
		<div class="sidebar-list">
			<a id="sidebar-header" onclick="toggleSubmenu(event)">
		<span class="toggle-icon">+</span>
				4. Simulating ERPs
			</a>
			<div class="submenu">
				<a href="/textbook/content/05_erps/erps_in_gui.html">4.1 GUI Tutorial of ERPs Simulation</a>
				<a href="/textbook/content/05_erps/hnn_core.html">4.2 API Tutorial of ERPs Simulation</a>
			</div>
		</div>
		<div class="sidebar-list">
			<a id="sidebar-header" onclick="toggleSubmenu(event)">
		<span class="toggle-icon">+</span>
				5. Simulating Alpha/Beta Rhythms
			</a>
			<div class="submenu">
				<a href="/textbook/content/06_alpha_beta/gui.html">5.1 GUI Tutorial of Alpha/Beta Rhythms</a>
				<a href="/textbook/content/06_alpha_beta/api.html">5.2 API Tutorial of Alpha/Beta Rhythms</a>
			</div>
		</div>
		<div class="sidebar-list">
			<a id="sidebar-header" onclick="toggleSubmenu(event)">
		<span class="toggle-icon">+</span>
				6. Simulating Gamma Rhythms
			</a>
			<div class="submenu">
				<a href="/textbook/content/07_gamma/gamma_in_gui.html">6.1 GUI Tutorial of Gamma Rhythms</a>
				<a href="/textbook/content/07_gamma/gamma_in_api.html">6.2 API Tutorial of Gamma Rhythms</a>
			</div>
		</div>
		<div class="sidebar-list">
			<a id="sidebar-header" onclick="toggleSubmenu(event)">
		<span class="toggle-icon">+</span>
				7. Using the HNN API
			</a>
			<div class="submenu">
				<a href="/textbook/content/08_using_hnn_api/plot_firing_pattern.html">7.1 Plot Firing Pattern</a>
				<a href="/textbook/content/08_using_hnn_api/record_and_plot_extracellular_potentials.html">7.2 Record & Plot Extracellular Potentials</a>
				<a href="/textbook/content/08_using_hnn_api/modifying_local_connectivity.html">7.3 Modifying Local Connectivity</a>
				<a href="/textbook/content/08_using_hnn_api/animating_hnn_simulations.html">7.4 Animating HNN Simulations</a>
				<a href="/textbook/content/08_using_hnn_api/batch_simulation.html">7.5 Batch Simulation</a>
				<a href="/textbook/content/08_using_hnn_api/simulate_beta_modulated_erp.html">7.6 Simulate Beta-modulated ERP</a>
				<a href="/textbook/content/08_using_hnn_api/parallelism_joblib.html">7.7 Parallelism: Joblib</a>
				<a href="/textbook/content/08_using_hnn_api/parallelism_mpi.html">7.8 Parallelism: MPI</a>
				<a href="/textbook/content/08_using_hnn_api/optimize_simulated_evoked_response_parameters.html">7.9 Optimize simulated evoked response parameters</a>
				<a href="/textbook/content/08_using_hnn_api/optimize_simulated_rhythmic_response_parameters.html">7.10 Optimize simulated rhythmic response parameters</a>
			</div>
		</div>
		<div class="sidebar-list">
			<a id="sidebar-header" onclick="toggleSubmenu(event)">
		<span class="toggle-icon">+</span>
				8. From Data to Simulation
			</a>
			<div class="submenu">
				<a href="/textbook/content/09_data_to_simulation/from_meg_to_hnn.html">8.1 From MEG sensor-space data to HNN simulation</a>
			</div>
		</div>
	<div style='height: 30px;'></div>
	</div>


    <div class="topbar">
        
        <!-- Topbar menu -->
        <div class="menu-container">
            <div class="menu-icons">
                <button class="openbtn" onclick="toggleNav()">
                    ☰
                </button>
                <a href="https://hnn.brown.edu" class="home-link">
                    <div class="home-icon-container">
                        <svg
                            xmlns="http://www.w3.org/2000/svg"
                            width="24" 
                            height="24"
                            viewBox="0 0 24 24" 
                            class="home-icon">
                            <path
                                d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"
                            />
                        </svg>
                    </div>
                </a>
                <button class="theme-toggle">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
                        <path d="M361.5 1.2c5 2.1 8.6 6.6 9.6 11.9L391 121l107.9 19.8c5.3 1 9.8 4.6 11.9 9.6s1.5 10.7-1.6 15.2L446.9 256l62.3 90.3c3.1 4.5 3.7 10.2 1.6 15.2s-6.6 8.6-11.9 9.6L391 391 371.1 498.9c-1 5.3-4.6 9.8-9.6 11.9s-10.7 1.5-15.2-1.6L256 446.9l-90.3 62.3c-4.5 3.1-10.2 3.7-15.2 1.6s-8.6-6.6-9.6-11.9L121 391 13.1 371.1c-5.3-1-9.8-4.6-11.9-9.6s-1.5-10.7 1.6-15.2L65.1 256 2.8 165.7c-3.1-4.5-3.7-10.2-1.6-15.2s6.6-8.6 11.9-9.6L121 121 140.9 13.1c1-5.3 4.6-9.8 9.6-11.9s10.7-1.5 15.2 1.6L256 65.1 346.3 2.8c4.5-3.1 10.2-3.7 15.2-1.6zM160 256a96 96 0 1 1 192 0 96 96 0 1 1 -192 0zm224 0a128 128 0 1 0 -256 0 128 128 0 1 0 256 0z"></path>
                    </svg>
                </button>
                <div class="dropdown">
                    <button 
                        id="dropdownButton" 
                        class="dropdown-button">
                            <img
                                src="/textbook/content/assets/icons/fontsize.png"
                                alt="fontsize"
                            />
                    </button>
                    <div class="dropdown-content">
                        <button 
                            class="fontsize-btn" 
                            onclick="decreaseFontSize()">
                            <img
                                src="/textbook/content/assets/icons/fontminus.png"
                                alt="fontminus"
                            />
                        </button>
                        <button 
                            class="fontsize-btn" 
                            onclick="increaseFontSize()">
                            <img
                                src="/textbook/content/assets/icons/fontplus.png"
                                alt="fontplus"
                            />
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Topbar image -->
        <div class="topbar-logo-container">
            <img 
                id="topbar-logo"
                src="https://raw.githubusercontent.com/jonescompneurolab/jones-website/master/images/frontpage/logos/logo-hnn-medium.png"
            />
        </div>

        <!-- Right side of topbar -->
        <div class="socials-container">
            <div class="social-icons">
                <a 
                    href="https://github.com/jonescompneurolab/hnn-core" 
                    target="_blank" 
                    aria-label="GitHub">
                    <img 
                        src="/textbook/content/assets/icons/github.png"
                        alt="GitHub">
                </a>
                <a 
                    href="https://bsky.app/profile/hnnsolver.bsky.social" 
                    target="_blank"
                    aria-label="BlueSky">
                    <img 
                        src="/textbook/content/assets/icons/bluesky.png"
                        alt="BlueSky">
                </a>
                <a 
                    href="https://www.linkedin.com/company/human-neocortical-neurosolver/" 
                    target="_blank"
                    aria-label="LinkedIn">
                    <img 
                        src="/textbook/content/assets/icons/linkedin.png"
                        alt="LinkedIn">
                </a>
            </div>
        </div>
    </div>

    <div id="main">
    <div id="content-wrapper">
    <div id="content">

<!--
# Title: 6.2 API Tutorial of Gamma Rhythms
# Updated: 2025-02-14
#
# Contributors:
    # Dylan Daniels
-->

        <div class="notebook-download-wrapper">
            <a href='plot_simulate_gamma.ipynb' download>
                <button class="notebook-download">
                    <svg xmlns="http://www.w3.org/2000/svg"
                        width="20" height="20" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                        <polyline points="7 10 12 15 17 10"/>
                        <line x1="12" y1="15" x2="12" y2="3"/>
                    </svg>
                    <span style="width: 8px"></span>
                    <span>Download Notebook</span>
                </button>
            </a>
        </div>

    
<div class='markdown-cell'>
    <h1>6.2 API Tutorial of Gamma Rhythms</h1>
<p>This example demonstrates how to simulate gamma rhythms via the well
established pyramidal-interneuron-gamma mechanisms [1], as detailed in
the <a href="">HNN GUI gamma tutorial</a>, using HNN-Core.</p>
<p>We recommend you first review the GUI tutorial. The workflow below
recreates weak gamma rhythms similar to Figures 4 and 5 of the GUI
tutorial, and strong gamma rhythms similar to Figure 12 and 13 in the
GUI tutorial.</p>

</div>
<div class='code-cell'>
    <code class='language-python'>
        # Authors: Mainak Jas <mjas@mgh.harvard.edu>
#          Sam Neymotin <samnemo@gmail.com>
#          Christopher Bailey <bailey.cj@gmail.com>

# sphinx_gallery_thumbnail_number = 2

import os.path as op
    </code>
</div>
<div class='markdown-cell'>
    <p>Let us import hnn_core</p>

</div>
<div class='code-cell'>
    <code class='language-python'>
        import hnn_core
import matplotlib.pyplot as plt
from hnn_core import simulate_dipole, read_params, jones_2009_model

hnn_core_root = op.dirname(hnn_core.__file__)
    </code>
</div>
<div class='markdown-cell'>
    <p>Read the parameter file and print the between-cell connectivity
parameters. Note that these are different compared with the 'default'
parameter set used in, e.g.,
<code>sphx_glr_auto_examples_workflows_plot_simulate_alpha.py</code>.</p>

</div>
<div class='code-cell'>
    <code class='language-python'>
        params_fname = op.join(
    hnn_core_root,
    'param',
    'gamma_L5weak_L2weak.json'
)
params = read_params(params_fname)
print(params['gbar_L*'])
    </code>
</div>
<div class='output-cell'><div class='output-label'>
    Out:
</div>
    <div class='output-code'>
        {
    &quot;gbar_L2Basket_L2Basket&quot;: 0.01,
    &quot;gbar_L2Basket_L2Pyr_gabaa&quot;: 0.007,
    &quot;gbar_L2Basket_L2Pyr_gabab&quot;: 0.0,
    &quot;gbar_L2Basket_L5Pyr&quot;: 0.0,
    &quot;gbar_L2Pyr_L2Basket&quot;: 0.0012,
    &quot;gbar_L2Pyr_L2Pyr_ampa&quot;: 0.0,
    &quot;gbar_L2Pyr_L2Pyr_nmda&quot;: 0.0,
    &quot;gbar_L2Pyr_L5Basket&quot;: 0.0,
    &quot;gbar_L2Pyr_L5Pyr&quot;: 0.0,
    &quot;gbar_L5Basket_L5Basket&quot;: 0.0075,
    &quot;gbar_L5Basket_L5Pyr_gabaa&quot;: 0.08,
    &quot;gbar_L5Basket_L5Pyr_gabab&quot;: 0.0,
    &quot;gbar_L5Pyr_L5Basket&quot;: 0.00091,
    &quot;gbar_L5Pyr_L5Pyr_ampa&quot;: 0.0,
    &quot;gbar_L5Pyr_L5Pyr_nmda&quot;: 0.0
}

    </div>
</div>
<div class='markdown-cell'>
    <p>We'll next add a tonic Poisson-distributed excitation to pyramidal
cells</p>

</div>
<div class='code-cell'>
    <code class='language-python'>
        net = jones_2009_model(params)

weights_ampa = {
    'L2_pyramidal': 0.0008,
    'L5_pyramidal': 0.0075,
}
synaptic_delays = {
    'L2_pyramidal': 0.1,
    'L5_pyramidal': 1.0,
}
rate_constant = {
    'L2_pyramidal': 140.0,
    'L5_pyramidal': 40.0,
}
net.add_poisson_drive(
    'poisson',
    rate_constant=rate_constant,
    weights_ampa=weights_ampa,
    location='proximal',
    synaptic_delays=synaptic_delays,
    event_seed=1349
)
    </code>
</div>
<div class='markdown-cell'>
    <p>And then we'll simulate the dipole moment in a single trial. (Note:
the default value used by <code>simulate_dipole</code> is
n_trials=params["N_trials"].)</p>

</div>
<div class='code-cell'>
    <code class='language-python'>
        dpls = simulate_dipole(
    net,
    tstop=250.,
)
scaling_factor = 30000
dpls = [dpl.scale(scaling_factor) for dpl in dpls]  # scale in place
    </code>
</div>
<div class='output-cell'><div class='output-label'>
    Out:
</div>
    <div class='output-code'>
        Joblib will run 1 trial(s) in parallel by distributing trials over 1 jobs.
Loading custom mechanism files from /usr/share/miniconda/envs/textbook-env-mpi/lib/python3.12/site-packages/hnn_core/mod/x86_64/libnrnmech.so
Building the NEURON model

        [Done]
Trial 1: 0.03 ms...

        Trial 1: 10.0 ms...
Trial 1: 20.0 ms...
Trial 1: 30.0 ms...
Trial 1: 40.0 ms...
Trial 1: 50.0 ms...
Trial 1: 60.0 ms...
Trial 1: 70.0 ms...
Trial 1: 80.0 ms...

        Trial 1: 90.0 ms...
Trial 1: 100.0 ms...
Trial 1: 110.0 ms...
Trial 1: 120.0 ms...

        Trial 1: 130.0 ms...
Trial 1: 140.0 ms...
Trial 1: 150.0 ms...
Trial 1: 160.0 ms...
Trial 1: 170.0 ms...
Trial 1: 180.0 ms...

        Trial 1: 190.0 ms...
Trial 1: 200.0 ms...
Trial 1: 210.0 ms...

        Trial 1: 220.0 ms...
Trial 1: 230.0 ms...
Trial 1: 240.0 ms...

    </div>
</div>
<div class='markdown-cell'>
    <p>Take a look at how different cell types respond to the exogenous
drive. Note the periodic firing pattern of all cell types. While the
basket cells fire relatively synchronously, the pyramidal cell
populations display a more varied pattern, in which only a fraction of
cells reach firing threshold.</p>

</div>
<div class='code-cell'>
    <code class='language-python'>
        _ = net.cell_response.plot_spikes_raster()

plt.show()
    </code>
</div>
<div class='output-cell'><div class='output-label'>
    Out:
</div>
    <div class='output-code'>
        &lt;Figure size 640x480 with 1 Axes&gt;
    </div>
</div>
<div class='output-cell'>
    <img src='output_nb_plot_simulate_gamma/fig_01.png'/>
</div>
<div class='markdown-cell'>
    <p>To confirm that the periodicity observed in the firing patterns
correspond to a population oscillation in the gamma-range, we can plot
the time-frequency representation together with the signal. Note that
the network requires some time to reach steady state. Hence, we omit the
first 50 ms in our analysis.</p>

</div>
<div class='code-cell'>
    <code class='language-python'>
        tmin = 50
trial_idx = 0  # pick first trial

# plot dipole time course and time-frequency
# representation in same figure
import numpy as np
import matplotlib.pyplot as plt

fig, axes = plt.subplots(
    nrows=2,
    ncols=1,
    sharex=True,
    figsize=(6, 6),
    constrained_layout=True,
)

dpls[trial_idx].plot(
    tmin=tmin,
    ax=axes[0],
    show=False,
)

# Create an fixed-step tiling of frequencies 
# from 20 to 100 Hz in steps of 1 Hz
freqs = np.arange(20., 100., 1.)
dpls[trial_idx].plot_tfr_morlet(
    freqs,
    n_cycles=7,
    tmin=tmin,
    ax=axes[1],
    show=False,
)

# adjust the bounds of the x axis in the spectrogram
axes[1].set_xlim(tmin, 250)

plt.show()
    </code>
</div>
<div class='output-cell'><div class='output-label'>
    Out:
</div>
    <div class='output-code'>
        &lt;Figure size 600x600 with 3 Axes&gt;
    </div>
</div>
<div class='output-cell'>
    <img src='output_nb_plot_simulate_gamma/fig_02.png'/>
</div>
<div class='markdown-cell'>
    <p>Now, let us try to re-run the simulation with a tonic bias applied to
the L5 Pyramidal cells. Notice that the oscillation waveform is more
regular, with less noise due to the fact that the tonic depolarization
dominates over the influence of the Poisson drive. By default, a tonic
bias is applied to the entire duration of the simulation.</p>

</div>
<div class='code-cell'>
    <code class='language-python'>
        net.add_tonic_bias(
    cell_type='L5_pyramidal',
    amplitude=6.,
)
dpls = simulate_dipole(
    net,
    tstop=250.,
    n_trials=1,
)
dpls = [dpl.scale(scaling_factor) for dpl in dpls]  # scale in place
    </code>
</div>
<div class='output-cell'><div class='output-label'>
    Out:
</div>
    <div class='output-code'>
        Joblib will run 1 trial(s) in parallel by distributing trials over 1 jobs.
Building the NEURON model

        [Done]
Trial 1: 0.03 ms...

        Trial 1: 10.0 ms...
Trial 1: 20.0 ms...
Trial 1: 30.0 ms...
Trial 1: 40.0 ms...

        Trial 1: 50.0 ms...
Trial 1: 60.0 ms...

        Trial 1: 70.0 ms...
Trial 1: 80.0 ms...
Trial 1: 90.0 ms...
Trial 1: 100.0 ms...
Trial 1: 110.0 ms...
Trial 1: 120.0 ms...
Trial 1: 130.0 ms...
Trial 1: 140.0 ms...

        Trial 1: 150.0 ms...
Trial 1: 160.0 ms...
Trial 1: 170.0 ms...
Trial 1: 180.0 ms...
Trial 1: 190.0 ms...
Trial 1: 200.0 ms...
Trial 1: 210.0 ms...
Trial 1: 220.0 ms...

        Trial 1: 230.0 ms...
Trial 1: 240.0 ms...

    </div>
</div>
<div class='code-cell'>
    <code class='language-python'>
        _ = dpls[trial_idx].plot()

plt.show()
    </code>
</div>
<div class='output-cell'><div class='output-label'>
    Out:
</div>
    <div class='output-code'>
        &lt;Figure size 640x480 with 1 Axes&gt;
    </div>
</div>
<div class='output-cell'>
    <img src='output_nb_plot_simulate_gamma/fig_03.png'/>
</div>
<div class='markdown-cell'>
    <p>Notice that the Layer 5 pyramidal neurons now fire nearly
synchronously, leading to a synchronous activation of the inhibitory
basket neurons, resulting in a low-latency IPSP back onto the pyramidal
cells. The duration of the IPSP is ~20 ms, after which the combined
effect of the tonic bias and Poisson drive is to bring the pyramidal
cells back to firing threshold, creating a ~50 Hz PING rhythm. This type
of synchronous rhythm is sometimes referred to as “strong” PING.</p>

</div>
<div class='code-cell'>
    <code class='language-python'>
        _ = net.cell_response.plot_spikes_raster()

plt.show()
    </code>
</div>
<div class='output-cell'><div class='output-label'>
    Out:
</div>
    <div class='output-code'>
        &lt;Figure size 640x480 with 1 Axes&gt;
    </div>
</div>
<div class='output-cell'>
    <img src='output_nb_plot_simulate_gamma/fig_04.png'/>
</div>
<div class='markdown-cell'>
    <p>Although the simulated dipole signal demonstrates clear periodicity,
its frequency is lower compared with the "weak" PING simulation
above.</p>

</div>
<div class='code-cell'>
    <code class='language-python'>
        from hnn_core.viz import plot_psd
_ = plot_psd(
    dpls[trial_idx],
    fmin=20.,
    fmax=100.,
    tmin=tmin,
)

plt.show()
    </code>
</div>
<div class='output-cell'><div class='output-label'>
    Out:
</div>
    <div class='output-code'>
        &lt;Figure size 640x480 with 1 Axes&gt;
    </div>
</div>
<div class='output-cell'>
    <img src='output_nb_plot_simulate_gamma/fig_05.png'/>
</div>
<div class='markdown-cell'>
    <p>Finally, we demonstrate the mechanistic link between PING and the
GABAA decay time constant (<code>tau2</code>). Using the same
network/drive configuration as before, we decrease <code>tau2</code>
from 5 to 2 ms.</p>

</div>
<div class='code-cell'>
    <code class='language-python'>
        net.cell_types['L5_pyramidal'].synapses['gabaa']['tau2'] = 2

dpls = simulate_dipole(
    net,
    tstop=250.,
    n_trials=1,
)
dpls = [dpl.scale(scaling_factor) for dpl in dpls]  # scale in place
    </code>
</div>
<div class='output-cell'><div class='output-label'>
    Out:
</div>
    <div class='output-code'>
        Joblib will run 1 trial(s) in parallel by distributing trials over 1 jobs.
Building the NEURON model

        [Done]
Trial 1: 0.03 ms...

        Trial 1: 10.0 ms...
Trial 1: 20.0 ms...
Trial 1: 30.0 ms...
Trial 1: 40.0 ms...

        Trial 1: 50.0 ms...
Trial 1: 60.0 ms...
Trial 1: 70.0 ms...
Trial 1: 80.0 ms...
Trial 1: 90.0 ms...
Trial 1: 100.0 ms...
Trial 1: 110.0 ms...
Trial 1: 120.0 ms...
Trial 1: 130.0 ms...

        Trial 1: 140.0 ms...
Trial 1: 150.0 ms...

        Trial 1: 160.0 ms...
Trial 1: 170.0 ms...
Trial 1: 180.0 ms...
Trial 1: 190.0 ms...
Trial 1: 200.0 ms...
Trial 1: 210.0 ms...

        Trial 1: 220.0 ms...
Trial 1: 230.0 ms...
Trial 1: 240.0 ms...

    </div>
</div>
<div class='markdown-cell'>
    <p>This change will shorten the effective refactory period between L5
pyramidal cell spikes and increase the PING frequency from ~50 to ~65
Hz, as seen in the plots below</p>

</div>
<div class='code-cell'>
    <code class='language-python'>
        fig, axes = plt.subplots(
    nrows=3,
    ncols=1,
    sharex=True,
    figsize=(6, 6),
    constrained_layout=True,
)

dpls[trial_idx].plot(
    ax=axes[0],
    show=False,
)

net.cell_response.plot_spikes_raster(
    ax=axes[1],
    show=False,
)

dpls[trial_idx].plot_tfr_morlet(
    freqs,
    n_cycles=7,
    tmin=tmin,
    ax=axes[2],
    show=False,
)

# adjust the bounds of the x axis in the spectrogram
axes[2].set_xlim(tmin, 250)

plt.show()
    </code>
</div>
<div class='output-cell'><div class='output-label'>
    Out:
</div>
    <div class='output-code'>
        &lt;Figure size 600x600 with 4 Axes&gt;
    </div>
</div>
<div class='output-cell'>
    <img src='output_nb_plot_simulate_gamma/fig_06.png'/>
</div><div class='markdown-cell'>
    <h2>References</h2>
<p>[1] Lee, S. &amp; Jones, S. R. Distinguishing mechanisms of gamma
frequency oscillations in human current source signals using a
computational model of a laminar neocortical network. Frontiers in human
neuroscience (2013)</p>

</div>
        <!-- footer area -->
        <!----------------->
        <div class="footer-area">
            <div class="previous-area" data-link="/textbook/content/07_gamma/gamma_in_gui.html">
                <div class="previous-icon">
                    <svg class="svg-arrow" width="25" height="25" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path class="arrow-path" d="M15 5L9 12L15 19" />
                    </svg>
                </div>
                <div class="previous-text">
                    <p>Previous</p>
                    <a>6.1 GUI Tutorial of Gamma Rhythms</a>
                </div>
            </div>
            <div class="next-area" data-link="/textbook/content/08_using_hnn_api/plot_firing_pattern.html">
                <div class="next-text">
                    <p>Next</p>
                    <a>7.1 Plot Firing Pattern</a>
                </div>
                <div class="next-icon">
                    <svg class="svg-arrow" width="25" height="25" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path class="arrow-path" d="M15 5L9 12L15 19" />
                    </svg>
                </div>
            </div>
        </div> <!-- close footer -->
    </div> <!-- close content -->
    </div> <!-- close content wrapper -->
</div> <!-- close main --><!------------------------ #
# Code syntax highlighting #
# ------------------------->
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>

<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />


</body>
</html>